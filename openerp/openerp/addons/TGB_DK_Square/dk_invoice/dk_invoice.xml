<?xml version="1.0"?>
<openerp>
    <data>

        <record model="ir.ui.view" id="tgb_dksquare_invoice_form">
            <field name="name">dk.account.invoice.form</field>
            <field name="model">account.invoice</field>
            <field name="arch" type="xml">
                <form string="Invoices" version="7.0" create="false">
                    <header>
                        <button name="invoice_open" states="draft" string="Validate" class="oe_highlight" groups="base.group_user"/>
                        <button name="invoice_open" states="proforma2" string="Validate" groups="base.group_user"/>
                        <button name="invoice_cancel" states="draft,proforma2,open" string="Cancel Invoice" groups="base.group_no_one"/>
                        <button name="action_cancel_draft" states="cancel" string="Reset to Draft" type="object" groups="base.group_user"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,open,paid"
                               statusbar_colors='{"proforma":"blue","proforma2":"blue"}'/>
                    </header>
                    <sheet string="Invoice">
                        <field name="dk_company_logo" widget="image" class="oe_left oe_avatar"/>
                        <div class="oe_title">
                            <h1>
                                <field name="dk_company_name" default_focus="1" placeholder="Name"/>
                            </h1>
                            <p><field name="dk_company_street" class="oe_inline"/>
                                <br/>
                                <field name="dk_company_rml_report_footer" class="oe_inline"/>
                                <br/>
                            </p>
                        </div>
                        <group>
                            <group>
                                <field string="Customer" name="partner_id"
                                       on_change="onchange_partner_id(type,partner_id,date_invoice,payment_term, partner_bank_id,company_id)"
                                       groups="base.group_user"
                                       context="{'search_default_customer':1, 'show_address': 1}"
                                       options='{"always_reload": True}'
                                       domain="[('customer', '=', True)]"/>
                            </group>
                            <group>
                                <field name="number" readonly="1" class="oe_inline"  invisible=""/>
                                <field name="contract_id" string="Our Ref"/>
                                <field name="date_invoice"/>
                            </group>
                            <group colspan="8" col="8">
                                <div class="oe_inline" colspan="8">
                                    <p><b>RE: PROPOSED 1 YEAR  <field name="contract_type" class="oe_inline"/> AIR-CONDITIONING SERVICE CONTRACT</b></p>
                                    <p>DK SQUARE ENGINEERING agrees to provide <field name="contract_type2" class="oe_inline"/> service &amp;amp; maintainance of air-conditioning contract of <field class="oe_inline" name="contract_amount" widget="monetary" options="{'currency_field': 'currency_id'}"/> per annum.</p>
                                </div>
                                <div class="oe_inline" colspan="8">
                                    <field name="dk_subject"/>
                                    <br/>
                                    <field name="dk_remark"/>
                                </div>
                                <div class="oe_inline" colspan="8">
                                    <p>Contract period from:<field name="contract_start_date" class="oe_inline"/> to <field name="contract_end_date" class="oe_inline"/> </p>
                                </div>
                                <field name="contact_person_id" context="{'search_default_customer':1, 'show_address': 1}"
                                       options='{"always_reload": True}'
                                       domain="[('customer', '=', True)]"/>
                                <newline/>
                                <field name = "contact_person_phone"/>
                                <newline/>
                                <div class="oe_inline" colspan="4">
                                    <p>Yours faithfully:</p>
                                    <field name="dk_company_id"/>
                                    <br/>
                                    <br/>
                                    <br/>
                                    <hr/>
                                    <field name="appoint_holder"/>
                                    <br/>
                                    HP: <field name="appoint_holder_phone" class="oe_inline"/>
                                </div>
                                <div class ="oe_inline" colspan="4">
                                    <p> Accepted &amp;amp; confirmed by</p>
                                    <br/>
                                    <br/>
                                    <br/>
                                    <hr/>
                                    <p>Company chop &amp;amp; signatory</p>
                                </div>
                                <div clas="oe_inline" colspan="8">
                                    <p>
                                        I/WE, ACCEPTED &amp;amp; CONFIRMED ABOVE AIRCON SERVICE &amp;amp; MAINTENANCE CONTRACT AND ENCLOSED HERE WITH MY/OUR CHEQUE WITH FULL PAYMENT TO DK SQUARE ENGINEERING
                                    </p>
                                </div>
                                <field name="contract_ref_no" colspan="4"></field>
                                <field name="contract_date_order" colspan="4"/>
                                <newline></newline>
                                <field name="dk_bank_cheque_no" colspan="3"/>
                                <field name="dk_bank_cheque_amount" nolabel="1" widget="monetary" options="{'currency_field': 'currency_id'}" />
                                <field name="dk_bank_date" colspan="3"/>
                                <div colspan="8">
                                    <p>
                                        Please sign and return duplicate copy with full payment to our Office early so as to avoid delayed service.
                                    </p>
                                </div>
                            </group>

                            <notebook colspan="4" invisible="1">
                                <page string="Invoice Lines">
                                    <field name="invoice_line" nolabel="1" widget="one2many_list"
                                           context="{'type': type}">
                                        <tree string="Invoice Lines" editable="bottom">
                                            <field name="sequence" widget="handle"/>
                                            <field name="product_id"
                                                   on_change="product_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.currency_id, context, parent.company_id)"/>
                                            <field name="name"/>
                                            <field name="account_id" groups="account.group_account_user"
                                                   domain="[('company_id', '=', parent.company_id), ('journal_id', '=', parent.journal_id), ('type', '=', 'other')]"
                                                   on_change="onchange_account_id(product_id, parent.partner_id, parent.type, parent.fiscal_position,account_id)"/>
                                            <field name="account_analytic_id"
                                                   groups="analytic.group_analytic_accounting"
                                                   domain="[('type','!=','view'), ('company_id', '=', parent.company_id)]"/>
                                            <field name="quantity"/>
                                            <field name="uos_id" groups="product.group_uom"
                                                   on_change="uos_id_change(product_id, uos_id, quantity, name, parent.type, parent.partner_id, parent.fiscal_position, price_unit, parent.currency_id, context, parent.company_id)"/>
                                            <field name="price_unit"/>
                                            <field name="discount" groups="sale.group_discount_per_so_line"/>
                                            <field name="invoice_line_tax_id" widget="many2many_tags"
                                                   context="{'type':parent.type}"
                                                   domain="[('parent_id','=',False),('company_id', '=', parent.company_id)]"/>
                                            <field name="price_subtotal"/>
                                        </tree>
                                    </field>
                                    <group class="oe_subtotal_footer oe_right">
                                        <field name="amount_untaxed" widget="monetary"
                                               options="{'currency_field': 'currency_id'}"/>
                                        <div>
                                            <label for="amount_tax"/>
                                            <button name="button_reset_taxes" states="draft,proforma2"
                                                    string="(update)" class="oe_link oe_edit_only"
                                                    type="object" help="Recompute taxes and total"/>
                                        </div>
                                        <field name="amount_tax" nolabel="1" widget="monetary"
                                               options="{'currency_field': 'currency_id'}"/>
                                        <field name="amount_total" class="oe_subtotal_footer_separator"
                                               widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                        <field name="residual" groups="account.group_account_user" widget="monetary"
                                               options="{'currency_field': 'currency_id'}"/>
                                        <field name="reconciled" invisible="1"/>
                                    </group>
                                    <group>
                                        <field name="payment_term" class="oe_inline"/>
                                    </group>
                                    <div class="oe_clear">
                                        <label for="comment"/>
                                    </div>
                                    <field name="comment" class="oe_inline" placeholder="Additional notes..."/>
                                </page>
                                <page string="Additional Information">
                                    <group>
                                        <field name="type"/>
                                        <field domain="[('partner_id.ref_companies', 'in', [company_id])]"
                                               name="partner_bank_id"/>
                                        <field name="company_id"
                                               on_change="onchange_company_id(company_id,partner_id,type,invoice_line,currency_id)"
                                               widget="selection" groups="base.group_multi_company"/>
                                        <field name="currency_id" class="oe_inline"/>
                                        <field domain="[('company_id', '=', company_id),('type','=', 'receivable')]"
                                               name="account_id" groups="account.group_account_user"/>
                                        <field name="fiscal_position" widget="selection"/>
                                        <field name="company_id"/>
                                    </group>

                                </page>
                            </notebook>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>


        <record id="tgb_dksquare_invoice_action" model="ir.actions.act_window">
            <field name="name">Invoices</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.invoice</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="account.invoice_tree"/>
            <field name="context">{}</field>
        </record>

        <record id="action_dk_account_invoice_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="tgb_dksquare_invoice_form"/>
            <field name="act_window_id" ref="tgb_dksquare_invoice_action"/>
        </record>

        <record id="action_dk_account_invoice_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="account.invoice_tree"/>
            <field name="act_window_id" ref="tgb_dksquare_invoice_action"/>
        </record>

        <!--<menuitem name="Invoices"-->
                  <!--id="dk_square_invoice_menu" parent="menu_dk_square_contract_management"-->
                  <!--action="tgb_dksquare_invoice_action" />-->


    </data>
</openerp>
